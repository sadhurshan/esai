Quote Submission, Revisions, Withdrawal & Statuses

Status snapshot (2025-12-02)

1. ✅ **Supplier quote form coverage (price / lead time / MOQ / tax / notes / attachments)** – `resources/js/pages/quotes/supplier-quote-create-page.tsx` now renders the real document uploader (`AttachmentsInput`) backed by `useUploadDocument`/`useDeleteDocument`, FileDropzone previews, and DocumentAttachment metadata; `supplier-quote-schema.ts`/`supplier-quote-edit-page.tsx` map API payloads to the uploader while `buildSubmitQuotePayload` sends the selected document IDs. On the backend `app/Http/Requests/StoreQuoteRequest.php` validates the `attachments` array, and `app/Http/Controllers/Api/QuoteController.php` reassigns RFQ documents to the new quote (refreshing counts via `CompanyContext::bypass`). Coverage is locked in by `tests/Feature/Api/QuoteSubmissionTest.php::it_moves_referenced_rfq_documents_onto_the_quote_attachments_list`.
2. ✅ **Revision workflow & history** – `resources/js/pages/quotes/supplier-quote-edit-page.tsx` gates revision submission to the `submitted` status, requires a revision note, and posts via `useReviseQuote`, while the buyer-side `quote-detail-page.tsx` renders revisions and a timeline showing revision numbers and submitted timestamps. `tests/Feature/Api/QuoteRevisionFeatureTest.php` exercises revision creation, deadline checks, notification fan-out, and persistence of previous versions.
3. ✅ **Withdrawal reason surfaced to buyers** – Suppliers get a dedicated `WithdrawConfirmDialog` that enforces a reason before hitting `useWithdrawQuote`, and the resulting `withdraw_reason` + status bubble up in the quote timeline/overview (`quote-detail-page.tsx`). Backend coverage in `QuoteRevisionFeatureTest::it_allows_suppliers_to_withdraw_quotes...` verifies the status change, audit notifications, and the “no further revisions” guard.
4. ✅ **Status enum parity (draft, submitted, withdrawn, expired, rejected, awarded)** – Added an explicit `rejected` presentation in `resources/js/components/quotes/quote-status-badge.tsx` so buyer and supplier views now show the backend enum emitted during awards (`tests/Feature/Api/RfqLineAwardFeatureTest.php`). Existing mappings for `draft/submitted/withdrawn/expired/awarded` remain intact, and `lost` is still available if future APIs emit it.
5. ✅ **Deadline enforcement & UI feedback** – `resources/js/lib/rfq-response-window.ts` now centralizes the “response window closed” check, and both `supplier-quote-create-page.tsx` and `supplier-quote-edit-page.tsx` consume it to show a warning banner, disable inputs/attachments, and block save/submit/revise actions whenever the RFQ status isn’t `open` or the `deadlineAt` timestamp is in the past. This mirrors the backend guard in `app/Support/RfqResponseWindowGuard.php` and keeps buyers from seeing API errors after the fact.