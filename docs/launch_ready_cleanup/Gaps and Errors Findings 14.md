1. ~~NCR workflow absent (blocker) – The Receiving & Quality spec calls for dedicated NCR data (ncrs table with company scope) plus endpoints to raise/close NCRs and UI hooks for dashboards (receiving_quality.md; also reiterated in DB_PLAN.md under “Receiving & Quality” and in ACCEPTANCE.md where grns, grn_lines, and ncrs must ship together). The codebase only contains GRN models/controllers/routes; there is no migration, model, policy, controller, or route containing “ncr”, and even the approval workflow still carries a TODO placeholder for “when NCR model is available” (ApprovalWorkflowService.php). Front-end receiving pages (resources/js/pages/receiving/*) also lack any NCR creation/closure UI, so the non-conformance process described in the bible cannot exist on launch day. You’ll need to add the missing schema, Eloquent model (extending CompanyScopedModel + soft deletes), REST endpoints (POST /grns/{id}/ncrs, PATCH /ncrs/{id}), React modals/dashboards, and tests.~~ **(Fixed)** — Added `ncrs` + `goods_receipt_lines` migrations, `App\Models\Ncr`, policy, controller, FormRequests, actions, and API routes; wired audit + approval workflows, React NCR modal (raise/close) on `receiving-detail-page.tsx`, SDK hooks, and seed/tests so NCRs can be raised, summarized, and closed per spec.

2. ~~Invoice match records violate tenant/audit rules (critical) – 2025_11_09_020000_create_invoice_tables.php creates invoice_matches with only FK columns and result/details, omitting both company_id and softDeletes(). The model (InvoiceMatch.php) likewise extends the bare Model with no CompanyScopedModel/SoftDeletes. This contradicts the database plan’s multitenancy conventions (“Every tenant-owned record includes company_id… Business aggregates expose … deleted_at” – DB_PLAN.md). Without those columns you can’t scope or audit matches independently of invoices, and PerformInvoiceMatchAction currently hard‐deletes every previous record (::where('invoice_id', $invoice->id)->delete()), destroying the history the spec expects finance teams to review. Add company_id + indexes + softDeletes() to the migration (with a follow-up data backfill), update the model to extend CompanyScopedModel & use SoftDeletes, populate the column when creating matches, and replace the hard delete with soft deletes or versioning.~~ **(Fixed)** — New migration `2025_11_24_005000_add_company_scope_to_invoice_matches.php` adds `company_id`, soft deletes, and backfills data; `InvoiceMatch` now extends `CompanyScopedModel` with `SoftDeletes`, API resources expose the tenant id, and `PerformInvoiceMatchAction` persists `company_id` so matches stay scoped/auditable without hard deletes.

3. ~~Receiving attachments skip virus scanning (high) – The conventions explicitly require a virus-scan hook on every upload (“Files: … virus‑scan hook” in CONVENTIONS.md). Both attachment paths in receiving bypass that requirement: CreateGoodsReceiptNoteAction::storeAttachments() and AttachGoodsReceiptFileAction inject only DocumentStorer and immediately persist the file (CreateGoodsReceiptNoteAction.php & AttachGoodsReceiptFileAction.php). Unlike RFQ or supplier document flows (which call VirusScanner::assertClean()), GRN uploads never run through any scanner, so malicious packing slips/photos can be stored and shared. Wire the existing VirusScanner into these actions (or into DocumentStorer) so every GRN upload is scanned before storage, and add regression tests to assert rejections when the scanner reports an infection.~~ **(Fixed)** — Both `CreateGoodsReceiptNoteAction` and `AttachGoodsReceiptFileAction` now inject `VirusScanner`, assert files are clean before storage, and return validation errors when malware is detected; feature tests cover the rejection paths to prevent regressions.

4. ~~GRN line attachments use the wrong document kind (medium) – Line-level attachments saved through CreateGoodsReceiptNoteAction::storeAttachments() tag documents with 'kind' => 'po' even though DocumentKind exposes a dedicated GoodsReceipt = 'grn_attachment' and the note-level uploader already uses that value (CreateGoodsReceiptNoteAction.php vs. AttachGoodsReceiptFileAction.php). Because of this mismatch, line evidence shows up under purchase-order filters and never under receiving/QA filters, breaking document search and reporting. Switch the kind to DocumentKind::GoodsReceipt->value (or the literal 'grn_attachment') and migrate existing rows to the correct value so downstream queries stop misclassifying QA evidence.~~ **(Fixed)** — GRN line attachments now use `DocumentKind::GoodsReceipt` and migration `2025_11_24_010500_retag_grn_line_documents.php` retags historical `documents` rows so QA reports and filters no longer misclassify receiving evidence.